<script src="../rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="../rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="../rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="../rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="../rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="../rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="../rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="../rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="../rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../fonts.css">

<p>Recently, I’ve made several posts about analysing <a href="https://hansard.parliament.uk/">Hansards</a>, i.e. transcripts from British Parliamentary debates, which can be found <a href="/categories/hansard-text-analysis/">here</a>. A big part of that process is simply getting the Hansard from plaintext form to a <em>tidy data table</em>, where you have one column for the peer’s <code>name</code>, one for each <code>speech</code>, and then it’s also nice to have columns for <code>gender</code> and <code>party</code> along with a <code>speech_id</code> column.</p>
<p>Essentially, how do you go from this:</p>
<p><code>&quot;European Union (Notification of Withdrawal) Bill\r\n\r\nCommittee (2nd Day)\r\n\r\n15:37:00\r\n\r\nRelevant document: 8th Report from the Constitution Committee\r\n\r\nClause 1: Power to notify withdrawal from the EU\r\n\r\nAmendment 9A had been retabled as Amendment 16A.\r\n\r\nAmendment 9B\r\n\r\nMoved by\r\n\r\n9B: Clause 1, page 1, line 3, at end insert—\r\n “( ) Within three months of exercising the power under section 1(1), &quot;</code></p>
<p>To this:</p>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230"],["Baroness Hayter of Kentish Town","Viscount Hailsham","Baroness Ludford","Lord Howard of Lympne","Lord Howard of Lympne","Lord Richard","Lord Howard of Lympne","Lord Hannay of Chiswick","Lord Howard of Lympne","Baroness Farrington of Ribbleton","Lord Howard of Lympne","Lord Cormack","Lord Howard of Lympne","Lord Winston","Lord Howard of Lympne","Lord Bragg","The Countess of Mar","Lord Bragg","Baroness Goldie","The Archbishop of York","Baroness Jones of Moulsecoomb","The Archbishop of York","Lord Hannay of Chiswick","Lord Wigley","Lord Mackay of Clashfern","Lord Anderson of Swansea","Lord Mackay of Clashfern","Baroness Royall of Blaisdon","Lord Mackay of Clashfern","Lord Oates","Lord Spicer","Lord Oates","Viscount Ridley","Lord Oates","Lord Taylor of Holbeach","Lord Tebbit","Lord Tebbit","Lord Tebbit","Lord Cashman","Lord Tebbit","Baroness Royall of Blaisdon","Lord Tebbit","Lord Taylor of Holbeach","Baroness Kennedy of The Shaws","Lord Bowness","Viscount Waverley","Baroness Hamwee","Lord Kerslake","Lord Taylor of Holbeach","Lord Lawson of Blaby","Baroness Symons of Vernham Dean","Lord Campbell of Pittenweem","Lord Forsyth of Drumlean","Lord Campbell of Pittenweem","Lord Campbell of Pittenweem","Lord Campbell of Pittenweem","Lord Taylor of Holbeach","Lord Green of Deddington","Lord Taylor of Holbeach","Lord Kirkhope of Harrogate","Lord Clark of Windermere","Lord Green of Deddington","Lord Clark of Windermere","The Archbishop of York","Lord Clark of Windermere","Lord Taylor of Holbeach","Baroness Smith of Newnham","Lord Forsyth of Drumlean","Baroness Smith of Newnham","Lord Kerr of Kinlochard","Lord Davies of Stamford","Lord Taylor of Holbeach","Lord Blencathra","Lord Cormack","Lord Blencathra","Lord Taylor of Holbeach","Lord Woolf","Lord Strathclyde","Baroness Miller of Chilthorne Domer","Lord Strathclyde","Lord Bilimoria","Lord Strathclyde","Lord Bridges of Headley","Lord Davies of Stamford","Lord Taylor of Holbeach","Lord Davies of Stamford","Lord Taylor of Holbeach","Lord Bridges of Headley","Baroness Hayter of Kentish Town","Baroness Hayter of Kentish Town","Lord Teverson","Lord Hunt of Chesterton","Lord O'Neill of Clackmannan","Lord Krebs","The Earl of Selborne","Lord Hutton of Furness","Lord Inglewood","Lord Fox","Lord Rees of Ludlow","Lord Warner","Lord Lea of Crondall","Lord Hunt of Chesterton","Lord Lea of Crondall","Lord Hayward","Lord Wigley","Baroness Bowles of Berkhamsted","Lord Liddle","Baroness Miller of Chilthorne Domer","Lord Redesdale","Lord Bradshaw","Lord Oxburgh","Lord Stern of Brentford","Baroness Hayter of Kentish Town","Lord Keen of Elie","Lord Lea of Crondall","Lord Keen of Elie","Lord Hutton of Furness","Lord Keen of Elie","Lord Hutton of Furness","Lord Keen of Elie","Lord Redesdale","Lord Keen of Elie","Lord Oxburgh","Lord Keen of Elie","Baroness Young of Old Scone","Lord Keen of Elie","Lord Teverson","Baroness Jones of Moulsecoomb","Lord Wigley","Baroness Drake","Lord Bruce of Bennachie","Baroness Northover","Baroness Smith of Basildon","Lord Balfe","Lord De Mauley","Lord Balfe","Lord Balfe","Lord Bilimoria","Baroness Lister of Burtersett","Baroness Burt of Solihull","Baroness Crawley","Lord Wallace of Tankerness","Lord Judd","Lord Bridges of Headley","Lord Judd","Lord Taylor of Holbeach","Lord Judd","Lord Taylor of Holbeach","Lord Bridges of Headley","Baroness Smith of Basildon","Lord Bridges of Headley","Baroness Drake","Lord Bridges of Headley","Baroness Jones of Moulsecoomb","Lord Pannick","Lord Spicer","Lord Pannick","Lord Spicer","Viscount Hailsham","Lord Spicer","Lord Hannay of Chiswick","Lord Spicer","Lord Wigley","Lord Howard of Lympne","Lord Kerr of Kinlochard","Lord Howard of Lympne","Lord Tyler","Lord Howard of Lympne","Lord Pannick","Lord Howard of Lympne","Lord Hannay of Chiswick","Lord Howard of Lympne","Lord Oates","Lord De Mauley","Lord Oates","Lord De Mauley","Lord Oates","Lord Pannick","Lord Oates","Lord Faulks","Lord Oates","Lord Hope of Craighead","Lord Hannay of Chiswick","Lord Hope of Craighead","Baroness Goldie","Baroness Kennedy of The Shaws","Lord Howell of Guildford","Lord Hope of Craighead","Lord Howell of Guildford","Lord Deben","Lord Trevethin and Oaksey","Baroness Jones of Moulsecoomb","Lord True","Lord Tyler","Lord True","Lord Hannay of Chiswick","Lord True","Lord Tyler","Baroness Stowell of Beeston","Lord Higgins","Lord Lisvane","Viscount Hailsham","Lord Ashdown of Norton-sub-Hamdon","Baroness Hayter of Kentish Town","Lord Bridges of Headley","Lord Pannick","Baroness Hayter of Kentish Town","Lord Wigley","Lord Elystan-Morgan","Baroness Randerson","The Earl of Kinnoull","Lord Wigley","The Earl of Kinnoull","Lord Empey","Lord Wigley","Lord Empey","Baroness Ludford","The Earl of Kinnoull","Baroness Ludford","Lord Keen of Elie","Lord Wigley","Lord Keen of Elie","Baroness Hayter of Kentish Town","Lord Lea of Crondall","Lord Berkeley","Lord Stoneham of Droxford","Lord Bridges of Headley","Lord Berkeley","Lord Bridges of Headley","Lord Lea of Crondall"],["My Lords, it is a particular pleasure for me on St David’s Day to be opening this session on the Bill. I move Amendment 9B on behalf of the noble Lords, Lord Hannay and Lord Bowness, and the noble Bar","My Lords, in supporting this group of new clauses and amendments, I shall vote for any one of them that is most likely to commend itself to your Lordships’ House.Perhaps I may begin by acknowledging t","My Lords, in supporting Amendment 9B I shall speak also to Amendments 25 and 41. It is a pleasure to follow the powerful speech of the noble Viscount, Lord Hailsham, and to agree with the noble Barone","My Lords, it is a pleasure to follow the noble Baroness, but I do not know what evidence she has for her assertion that the Government intend to use this issue as a negotiating encounter for wider iss","There are murmurs from the Benches opposite, but there are no new facts in this debate. This is an issue that is essentially simple. The arguments have been gone through in the other place; there are ","A slight thought went through my mind as the noble Lord told us what will happen in the House of Commons: “If that is so, what is the point of the House of Lords?”.","There are many occasions when this House can bring forward new arguments and a fresh perspective on a situation, and genuinely make the other place think again. I do not believe that  this is one of t","My Lords, on the issue of new facts, does the noble Lord agree that one new fact is the communication from all the expatriate groups across the European Union that they wish the House to pass this ame","I am sure many of those groups made their views known when the matter was debated in the other place. Though of course their views need to be taken into account, I do not see that as tantamount to a n","My Lords, during this debate, which may be lengthy, it would be helpful for those of us sitting listening if speakers from the Conservative group of Peers did not refer to the Opposition raising objec","My Lords, I do not think I ever referred to the Opposition raising objections. The noble Baroness uttered a legitimate rebuke but I do not think it needed to be directed at me on this occasion.","I entirely endorse what my noble friend said when he replied to the last interjection. However, he told the House a few moments ago that he was a unilateralist on this issue. The whole theme of the re","My Lords, we could but the Government decided not to. I wish we would. I would like the Government to take that view but they decided not to. I believe that this House needs to face—","The noble Lord, Lord Howard, has made one major assertion repeatedly: he kept saying that there are no new facts. There are new facts and they are really important to the British economy. The Governme","My Lords, the debate in the other place was very recent. That fact, along with the others, was well known to those in the other place. With great respect, it is not a new fact. Clearly, many will disa","My Lords, 3 million foreign nationals in a population of about 65 million represents a minority. This country has benefited greatly from minorities for centuries. Sometimes they are minorities of a pe","My Lords, I am sorry to interrupt the noble Lord but he seems to be launching into a Second Reading speech. Perhaps he might confine his observations to the amendment in hand.","I thank the noble Countess. I have a short speech—about as third as long as the previous speech—and I have nearly finished it. I was wondering why the Prime Minister did not lead the remain campaign a","My Lords, we shall hear next from the most reverend Primate.","My Lords, Uganda was referred to by the noble Viscount, Lord Hailsham. It was regrettable that Idi Amin kicked out two types of Asians—British citizens and Ugandan citizens. My opposition to him was o","Does the most reverend Primate not understand the moral obligation on this Government? These people are not bargaining chips. If we say quite freely that they are free to stay, that gives the moral hi","I never want to see any human person used as a bargaining chip. They are made in God’s likeness and as far as I am concerned, they are people and must be treated according to the rule of law in this c","My Lords, I support Amendment 9B, which is in my name as well as those of the other three noble Lords. It is about the rights of EU citizens in this member state, of course, not those in other member ","My Lords, I support Amendment 9B, which overlaps with other amendments, including Amendment 37 in my name. There is a moral case—a human rights case—which has already been very well made and which I t","My Lords, what faces us today is an extremely serious issue, and I want to put before your Lordships the way I happen to look at it. Throughout the European Union there are a large number of people wh","What is the argument against a unilateral gesture on the part of this Government, generating good will which could permeate the rest of the negotiations? There is no need for any negotiations.","A unilateral declaration of that kind is not treating fairly all the people who are affected by this problem. The moral high ground is fairness and that is the only ground we can take in a negotiation","I respectfully point out to the noble and learned Lord and to the noble Lord, Lord Howard, that Liam Fox said at the Conservative Party conference that the uncertain status of EU nationals living in t","My Lords, I do not regard myself as bound by remarks made by Dr Liam Fox anywhere. I have been given the responsibility, so far, of being a Member of this House and of attempting to explain to your Lo","My Lords, I will speak to Amendments 16A and 38 and I also support Amendment 9B. Whether or not one favours a unilateral guarantee to EU citizens in this country, as I do, there  are key questions abo","My Lords, even if you are a Liberal Democrat you cannot have it both ways. You either give priority to people living here—those you think should have priority—or you do not. This amendment, which the ","Perhaps the noble Lord will forgive me but if he listens to my argument he will understand the answer to his question. Let us take, for example, an elderly couple, resident in Germany, who wrote to me","The noble Lord talks about fear and anxiety but does he agree that what we have heard this afternoon—the inflaming of the fears of these people—has come from only one side, including spurious mentions","My Lords, no, I do not agree with the noble Viscount for one moment. These are fears expressed to me and to noble Lords across the whole House. They are not manufactured; they are real and present, an","My Lords, we need to try to organise this debate so that we hear all sides of the argument. I hope that noble Lords will understand if I suggest that it is the turn of my noble friend Lord Tebbit.","My Lords, in a manner which has not been followed by anybody else in the House today, I should declare my interest in this matter. I have a nephew who has lived and worked in Germany for 20 years and ","Then perhaps he will do us the kindness of addressing us, because it is an almost unique experience.The other reason that this is a remarkable day for me is that, at a time when we so often hear slave","My Lords, people of nationalities of other countries within the Union are foreigners.","Will the noble Lord develop the argument about protecting the rights of UK citizens a little further? What would he say to a UK citizen married, perhaps, to a German or Dutch national and now worried ","That is exactly what the Prime Minister has said: we will look for an equitable solution. That means, in my view, that the rights of those who are currently resident here who, although they are not Br","My Lords, I point out to the noble Lord that the amendment is structured as it is because we are conscious of the powers of the British Government, who are able to determine the lives of the EU citize","Of course we do not have the power to look after our citizens overseas—not in these days when we do not have many gunboats—but we have an obligation to look after the rights of those people and  to lo","I am sorry. It is the turn of the Labour Party. I suggest we hear from the noble Baroness, Lady Kennedy.","My Lords, I support this amendment. I also have my name on Amendment 16A with the noble Lord, Lord Oates, and on Amendment 38. I want to reiterate the point about the position at the time of the refer","My Lords, I did not participate at Second Reading because I could not be present for the closing speeches, but I have either sat through, watched  or read all the proceedings. Had I been present, I wo","My Lords, emotions understandably run high on this issue, both here and on the continent. As a long-term resident on the continent, and after a lot of soul-searching over the weekend, including  consu","My Lords, I have tabled Amendment 25 on behalf of the Joint Committee on Human Rights, of which I am a member. It is also supported by the noble and learned Lord, Lord Woolf, and the noble Baroness, L","My Lords, I rise to speak in support of Amendment 25, to which I have added my name, and in general support of the amendments in this group. Like the noble Lord, Lord Tebbit, I declare my interests: a","My Lords, I think it would be appropriate to have my noble friend Lord Lawson and then hear from the Labour Benches.","My Lords, I assure your Lordships that I will be very brief indeed. I shall start by declaring an interest, an even more personal interest than that declared by my noble friend Lord Tebbit. My home is","My Lords, I have put on one side the remarks that I was going to make because I want to concentrate on the remarks made by the right reverend Prelate—I am sorry, the most reverend Primate—and I do so ","My Lords, I have the misfortune to disagree with the conclusions reached by the noble and learned Lord, Lord Mackay of Clashfern, although I agree with him about the disregard we should have for anyth","The noble Lord just made the point that he would rather have this amendment on the statute. I do not know if it has occurred to him but that is not for this House to decide but the other place, which ","Just as Brexit means Brexit, legally resident means legally resident.Noble LordsOh!","We might have to take the expert opinion of the noble and learned Lord, Lord Mackay of Clashfern, but I fancy that the courts will be able to reach a conclusion on that.I was saying that I endeavoured","No doubt the noble Lord will try and intervene at another stage, given his characteristically generous attitude towards the Liberal Democrats.The noble Viscount, Lord Hailsham, referred at the outset ","My Lords, I have suggested that we hear from the noble Lord, Lord Green. We will have a chance to hear from the noble Lord, Lord Kerr, later.","My Lords, I will speak to my Amendment 40 and comment on Amendment 9B, which is the main focus, of course, of the discussion. My own amendment has a clear and simple purpose: to place British citizens","My Lords, it is in fact the turn of the Conservatives.","My Lords, I was not able to be present at Second Reading, although I have—like, I am sure, other noble Lords—read the entire Hansard record of all the speeches that were made on that occasion. But lik","My Lords, I support Amendment 9B and shall speak to my own Amendment 42. Amendment 42 is very limited but I move it quite deliberately because it exemplifies much more of the wider debate. There have ","May I clarify what I said? Eighty-five per cent of EU migrants in the UK will have completed five years by the time we leave the European Union and therefore, in principle, would be entitled to perman","I am very grateful for that intervention and I am sure that the Minister will be as well.I have two points. The advantage of this amendment is that it is a win-win situation, because it is practically","It would be quite invidious to suggest that those of us who are sticking to the rules in relation to Bills do not understand pain or suffering. As far as I am concerned, the Bill deals solely with the","The point really is that we then move from the practical to the moral. Some of us take the belief that we have the high moral ground here and that is the ground which is occupied. I say this because w","My Lords, I believe the Lib Dems still want to make a contribution. Let us hear from the noble Baroness, Lady Smith.","My Lords, I shall be brief. It has been a long debate, but this issue has exercised your Lordships since the week after the referendum, when it appeared that there was virtual unanimity across this Ho","I normally have the greatest respect for the noble Baroness’s diligence, but she is wrong to say that nothing has changed. What has changed is that the Prime Minister has said that this is her first p","My Lords, we have heard much about the issue of EU nationals being a priority, but, as the noble Baroness, Lady Symons, pointed out, whatever the ambition of the Prime Minister and however great her n","My Lords, I very much agree with what the noble Baroness said at the end of her speech. As the noble Baroness, Lady Symons of Vernham Dean, said, this will be a nothing-is-agreed-until-everything-is-a","My Lords, I shall be very brief—","My Lords, it is the Conservative Party’s turn. The noble Lord, Lord Blencathra.","My Lords, I, too, will be brief. When I was supporting Vote Leave, I, like many others, took the view that we should make a grand unilateral gesture to state that we would grant residence rights and o","Would my noble friend not recognise that we are the ones walking out of the EU? We are the ones who have an obligation to those who, in all good faith, came to this country and invested their future i","Yes, my Lords, but we also owe an obligation to almost 1 million British citizens living in the EU who could be left in limbo for up to two years unless the EU addresses this issue urgently. It is the","My Lords, I hear the desire of some Members of the House to have Front-Bench speakers. However, it would be good to hear from the noble and learned Lord, Lord Woolf, and then from my noble friend Lord","My Lords, I will be extremely brief. After such an extensive debate, there is just one aspect that I would like to draw attention to. We are dealing here with residents in this jurisdiction who at pre","My Lords, much has been said this afternoon surrounding the whole issue of uncertainty. But the reason I cannot support these amendments is the fundamental flaw that lies at their heart: they will cre","I am one of those who lives in France, and I must therefore declare an interest. Perhaps the noble Lord did not hear the noble Lord, Lord Hannay, when he made the point that all the ex-pat UK groups l","I heard the noble Lord, Lord Hannay, loud and clear. What I suggest is: can we believe that these groups might be wrong and that, therefore, this House is putting at risk the future of a million Briti","I thank the noble Lord for giving way. He said that we should trust the British Government; the Home Secretary has written a letter to all of us in which she says:“I … reassure colleagues that Parliam","Very simply—the law can be changed only with the agreement of Parliament. That is why these amendments are at the wrong time, in the wrong Bill and on the wrong subject. We should support the rights o","My Lords, we have had a very good debate here tonight—","My Lords—Noble LordsThe Minister.","I think the mood of the House is to carry on and to hear from the Front Bench.","My Lords—Noble LordsOrder!","There is no constitutional crisis; there is good order in this House and I hope that the noble Lord will understand that we all want to hear from the Government Front Bench.","My Lords, the status of EU nationals living here and UK nationals living in the EU is, as this debate has so very clearly shown, one of the most emotive issues—if not the most emotive—created by our c","My Lords, it has been one of the highlights of one’s life in the House to hear this debate. I always like debates in which the words “moral” and “principle” are at the top of our agenda. I shall be br","I think my noble friend would probably testify that assurances are not enough. We want this on the face of the Bill. It would not delay the Bill or the negotiations; it simply asks the Government with","My Lords, I will reduce the temperature of the House a little during this debate, but I perhaps I will wait an atomic second, or minute, until one or two Members have disappeared.As I said, we are mov","My Lords, I support this amendment and I support the noble Lord, Lord Teverson, who is an expert on Euro law. Euratom has shown considerable importance for past and future research, and in the practic","My Lords, I am a supporter of nuclear power and I would like to facilitate nuclear energy in any way I can. However, I am not sure whether the legal forest through which the noble Lord, Lord Teverson,","My Lords, I refer to a report of the Science and Technology Select Committee from a few years ago, when I was its Chair, on the subject of nuclear R&amp;amp;D in this country. In doing so, I support this ","My Lords, I was lucky enough to serve on the Select Committee under the chairmanship of the noble Lord, Lord Krebs, and I now chair the Science and Technology Committee. We are revisiting this issue a","My Lords, I shall say a few brief words in support of the amendment that the noble Lord, Lord Teverson, has moved this evening. Before I say anything further, I should bring the attention of your Lord","My Lords, I rise to add a few words to what has already been said about the Euratom treaty and its relationship to the UK nuclear industry. I declare an interest as a Cumbrian and as chairman of Gen2,","My Lords, I too, have the pleasure of serving on the Science and Technology Select Committee under the watchful eye of the noble Earl, Lord Selborne, so I am sure he will mark my card next week at the","My Lords, I support this amendment. As a former member of the Science and Technology Select Committee, I particularly endorse the remarks of the noble Lord, Lord Krebs, and the noble Earl, Lord Selbor","My Lords, I, too, support these amendments and associate myself with the comments of the noble Lord, Lord Krebs, and the noble Earl, Lord Selborne. I, too, was on the inquiry of the Science and Techno","My Lords, I would like to add three points. I have a non-remunerated interest as patron of Trade Unions for Safe Nuclear Energy. The first point is on the referendum question. People have stretched it","That was not said about the Labour Party: it was said about a certain person in the Labour Party.","That was a cheap point from my noble friend. The Labour Party position was criticised and it led to some switching of votes. The fact is that the Conservative Party made a great number of gains by say","My Lords, I will raise a brief point in relation to Culham, to which there has been reference. I am Lord Hayward of Cumnor—and, for noble Lords who do not know the geography, Cumnor it is a mere few m","My Lords, I support Amendment 11, moved by the noble Lord, Lord Teverson. Amendment 23, to which I added my name, is grouped with it. I shall be brief because we have heard many experts who know much ","My Lords, I am in favour of this group of amendments. Amendment 39, in my name, follows the position that I suggested at Second Reading. The Euratom treaty is a separate treaty and can be separately a","My Lords, I support these amendments. As a member of Cumbria County Council I have an obvious interest in the prosperity of the nuclear industry in our part of the world. I will ask the Minister a num","My Lords, the nuclear industry has been widely mentioned this evening and I should briefly point out that under Euratom and as a nuclear power we have special responsibilities and obligations. The nuc","My Lords, from these Benches, I was the Lib Dem spokesman on energy for 10 years and was often the lone Peer who was attacking atomic energy as something we should be relying on. Our problem at the mo","My Lords, I live in the shadow of Culham. Like the noble Lord, Lord Hayward, I am well aware of the problems that this debate is already causing. I met a number of people from Culham last Thursday. A ","My Lords, by now the Minister will probably have got the message that this House thinks Euratom is pretty important for the reasons given. I shall not repeat them, but they are very sound. Indeed, sit","My Lords, we have heard very clear and convincing arguments about the future of Euratom. They are clear and strong. But it is more than that. Science depends on collaboration, mechanisms of collaborat","My Lords, I do not think I need to declare a particular interest. I happen to be married to a physicist, but he is a low-temperature physicist, whatever that is—he knows. Although his colleagues are a","My Lords, when one lawyer comes face to face with many scientists and nuclear experts and the issue is one of science, I know where my money would be. However, the issue is not one of science at this ","On the point, often made, that X, Y or Z is not what people voted for in the referendum, did people consciously vote to leave Euratom?","I am most obliged to the noble Lord for his second sight, because I was about to address that very point.In the context of the referendum, people voted to leave the European Union institutions. They v","I really did not want to interrupt the Minister; he has been very candid and helpful. Is it the Government’s intention to seek associate membership status of the Euratom treaty in order to continue to","It is not at present, as I understand it, our determined intention to seek associate member status, but that will be a matter for discussion in negotiation.Let us be clear: this is an area where there","But the only way that non-EU members of Euratom have been able to contribute and participate in the research programmes has been through associate membership.","I fully appreciate the noble Lord’s point. That is why we will engage with Euratom and its members in order to determine continuity. Whether it will be by associate membership or by means of some addi","If you look at Energy UK, which gives it by the half-hour, it is about 17% at the moment, but it goes up to about 22% and down to about 14%.","I am most obliged for that clarification. It will elide the need for me to write any letters.BEIS has a very direct interest in how its strategy is going to be developed, and here I commit not myself,","Twice in his speech, the Minister has commented that the UK was an international leader or a world leader in nuclear energy—I am not quite sure of the words he used—but it would be very unfortunate if","I am most obliged to the noble Lord, because it gives me the opportunity to refine the statement that I made. Essentially, we are world leaders in the area of nuclear fusion.","I should say that I am also a member of the Science and Technology Committee, which is looking at this issue at the moment. I am also a former nuclear waste regulator. Is it true to say that this caug","I am obliged to the noble Baroness. This Government are never caught on the hop.","My Lords, I thank everybody for their contribution to this extended meeting of the Science and Technology Committee of the House. I hope that the noble Earl will make sure that we are all on the atten","My Lords, Amendment 12 is about transitional arrangements. It would require the Government to set out, prior to triggering Article 50, a detailed plan for transitional arrangements with the EU coverin","My Lords, I have my name down in support of Amendment 16, which the noble Baroness, Lady Jones, just spoke to. It addresses the key question of ensuring that after Brexit and the repatriation of  EU l","My Lords, Amendment 33 is in my name. Many women voted in the referendum but few will have done so in the belief that the result could prejudice their rights. Despite assurances from Ministers on empl","My Lords, I speak to the amendment in my name and that of my noble and learned friend Lord Wallace of Tankerness. It has the simple objective of ensuring that the Government give high priority to maki","My Lords, I will speak to the last amendment in the group—in fact the last amendment on the order paper, although there is one more that still needs to be addressed. Then we will get into a general de","My Lords, I rise to speak to Amendment 20, in the names of my noble friends Lady Hayter and Lord Lennie and the noble Lord, Lord Kerslake, and also to comment on the other amendments that have been sp","My Lords, I declare an interest as a former Member of the European Parliament and all sorts of other things that the Daily Mail gets very worked up about us not declaring. We are debating the negotiat","I am grateful to my noble friend. Is he going to address the amendments?","I take the amendments as being about our negotiating stance and, as such, I consider that I am addressing them. Article 75 provides for third countries with concluded agreements to take part in the ag","Thank you very much. I ask noble Lords to understand that we are talking about the future of human beings. This is not something to jeer about. Because of my role in the trade union movement, I have m","My Lords, I agree with the noble Lord, Lord Balfe: we are talking about people. The greatest issue arising from the European Union referendum is the uncertainty that it is causing, in  every aspect of","My Lords, I very much support what the noble Lord just said, but I am speaking in support of Amendments 16 and 33. My main focus will be women’s rights—covered by Amendment 33—but first I want to ment","My Lords, I shall speak very briefly to Amendment 16 in my name and that of others and support all the amendments in this group. I will not delay the Committee for long, but it is important to explain","My Lords, I support these amendments. I particularly support my noble friend Lady Drake’s compelling case for preserving and improving workplace rights for women after we leave the European Union. Tha","This has been a wide-ranging debate. I put my name to Amendment 34. The fishing industry is important; part of the problem is that people have too often tried to shut the fishing industry up, when it ","My Lords—Noble LordsMinister!","My Lords, I think that the view of the Committee is probably that we should continue and that I should try to wrap this up.","My Lords—Noble LordsMinister! Order!","I think that there is a consensus that we should allow the Minister to address the Committee.","My Lords—Noble LordsOrder!","I thank the noble Lord and I call on the Minister to speak.","My Lords, we have discussed a veritable cornucopia of issues over the past hour and five minutes. Trying to sum up and string them together is something of a challenge, but I will attempt to do so. I ","The point that I was making was that they are not in the list of priorities. They may feature down the list, but consumer protection is not one of the Government’s 12 priorities.","The rights of consumers are very high in our minds. My noble friend Lord Balfe made an eloquent and passionate speech about the position of UK nationals in EU agencies and about the role of the agenci","The hour is late but this is an important point. I have chapter 7 of the White Paper in front of me. I seek clarity because the words in the document are quite general. Can the Minister give an assura","I totally understand the noble Baroness’s concern and interest in this issue. I will pick my words carefully. The Government’s position is that, through the great repeal Bill, EU law and regulations w","My Lords, I thank the Minister for his reply. It has been an interesting debate, ranging widely from women’s rights and the protection of minorities to education, medicine, foreign policy and fishing.","My Lords, Amendment 17 is in my name and those of the noble Baroness, Lady Hayter, and the noble Lords, Lord Hannay and Lord Oates. It would ensure parliamentary sovereignty at the end of the negotiat","My Lords, I am going to be very brief, because I have forgotten most of what I wanted to say. This is part of a group of amendments purporting to strengthen the role of Parliament in our affairs. Like","I am sorry, but the noble Lord is suggesting that I am bringing forward this amendment for some ulterior purpose. I voted to remain in the EU, but I entirely agree with the Government’s position that ","Of course I trust the noble Lord, but what he is doing is slowing down a process that we should get on with as quickly as possible in order to increase the sovereignty of Parliament. That is the whole","The purpose of the new clause that we are discussing is simply to ensure proper parliamentary control at the end of the negotiations. That does not slow down the negotiations; it merely ensures that a","I personally agree totally with anything that increases the sovereignty of parliament. I only make the point that this is totally unnecessary, because if we got on with this Bill, we would end up havi","I am not sure what is in the noble Lord’s mind. If he just tries reading the treaty, he will see that there is no basis for proceeding against the Government of the United Kingdom for not being a memb","I am also sure that the European court would have found a way into this at some point. I have no doubt about that at all. If one really is concerned with the sovereignty of Parliament, we should get o","My Lords, I support Amendment 17, moved by the noble Lord, Lord Pannick, which is linked to Amendment 35, standing in my name. Amendment 17 is critically important. If there is no clarity tonight, we ","My Lords, I oppose this amendment on grounds that are rather different from those advanced by my noble friend. I submit that this amendment is wrong in principle, constitutionally improper and unneces","I wonder if the noble Lord is familiar with Article 50, where it is clear that if no agreement is reached within the two-year period the state that intimated its intention to withdraw, if it has not w","It is hardly a fantasy if the negotiations are brought to an end speedily, as we all hope they will be. If they are brought to an end six months before the end of the two-year period, the process I id","I do not think that the noble Lords has followed the process of the Constitutional Reform and Governance Act 2010, which specifically gives both Houses of Parliament a role in the ratification of trea","I am afraid that it is the noble Lord who misunderstands the position. I am not disputing the role of Parliament in ratifying an agreement. That is perfectly proper, but that is different from Parliam","If all this is unnecessary, why was the Prime Minister asked for, and why did she give, a specific undertaking that this matter will be brought before both Houses of Parliament at the end of the proce","I think that I have already answered that question. I quite accept, as I said to the noble Lord, that it is proper for Parliament to ratify an agreement that has been reached—or, indeed, reject it. Th","Has the noble Lord given proper consideration to a circumstance in which the Prime Minister and the Government wish to throw in the towel in the negotiation? It cannot possibly be ruled out because, a","Well, for all the reasons that I have given. I do not want to repeat my speech to the noble Lord. The effect of the proposed new clause,  the effect of giving Parliament the ability to say, “You canno","My Lords, I support Amendment 17. Given the late hour and the clarity of the points made by the noble Lord, Lord Pannick, in moving the amendment, I will not detain your Lordships for too long, althou","If what the noble Lord, Lord Kerr, said earlier is correct, and I think it is, how does subsection (4) work?","I am not quite clear to which point made by the noble Lord, Lord Kerr, the noble Lord is referring.","If at the end of the two-year period we are out anyway, what is the impact of the Minister’s decision on termination?","The point of subsection (4) is that,“No Minister … may agree to the termination”,prior to that point. Clearly, that is the point of it.","The answer to the noble Lord’s question is that surely Parliament should decide, not the Government. Parliament should decide whether we  leave the EU with no agreement or whether we leave the EU with","I thank the noble Lord, Lord Pannick, for his clarity on that matter. In short, the amendment will ensure that Parliament will have a proper and meaningful oversight of the most important decision tha","The noble Lord will probably remember that at Second Reading the noble Lord, Lord Kerr of Kinlochard, indicated that he thought that the Europeans negotiating would give us an extension of the two-yea","No, I would not agree with that. Fascinating as it is for me to comment on what the noble Lord, Lord Kerr, said at Second Reading or otherwise, I will leave it to him to comment, but I do not agree th","My Lords, perhaps I can make my position clear. I think that we have four different attempts to find a solution to a problem that we are all looking for. For me, it would be neater if I made my points","I am most grateful to the noble Lord for giving way. I was following with great interest his ratiocination until he got to the point about neverendums. As the noble Lord, Lord Kerr, has made clear, th","I entirely understand the point that the noble Lord is making, but the trouble with subsection (4) is that it does not mention the two-year period—we do not know what period we are talking about. That","My Lords, I am aware that we have not heard from the Labour Benches at all in respect of this group of amendments and the noble Baroness, Lady Kennedy, has her name attached to one of the amendments.","I am grateful to the Minister and I hope that the noble Lord, Lord Howell, will not mind my stepping in here. I have my name attached to Amendment 31, but I really support Amendment 17 as it has been ","My Lords, I shall come at the amendments from a slightly different angle. It seems to me, listening to the debate, that those who have tabled them may not fully understand what goes on in the House of","One of the points made by the Supreme Court is that it is legislation that provides the authority for the kind of exercise we are talking about. It is all very well having Motions on the Floor of the ","My Lords, if Parliament voted to bring down the process—the whole confection the Government had worked on and negotiated over two years—it would not need a law, just a majority. Three or four years ag","My Lords, this is not a debate which will be solved on the basis of this group of amendments. It is quite clear that we have to make an amendment to ensure parliamentary sovereignty. I remind your Lor","My Lords, I hope that this is not too legalistic an intervention but I wish to seek some clarification. There have been a number of references to the Miller case. In paragraph 36 of its judgment, the ","My Lords, I support Amendment 31. I realise that I am feeling a bit fractious, which is probably because I have not had my dinner. I cannot answer for other noble Lords’ fractiousness this evening but","My Lords, I have a slightly different point to make. I do not want to repeat what I said to your Lordships on the first day of Committee but perhaps I may again read the Long Title of this legislation","It was the other way around.","I thank the noble Lord, Lord Tyler. So it was the other way around—358 to 256—which strengthens my argument. There is—if those 358 care to unite again and again—an insurmountable wall in your Lordship","I am grateful to the noble Lord. I wonder whether he has had a word with the Prime Minister, who basically coined this approach. She put in the Lancaster House speech a statement that both Houses shou","It may be that the noble Lord has more access to my right honourable friend than I do. My right honourable friend is perfectly capable of forming a judgment and I have no doubt we will hear from my no","My Lords, I have now served in Parliament for over 25 years—roughly half that time in each House. I do not think the noble Lord who has just spoken has had experience of the House the Commons.I want t","My Lords, I think we would serve ourselves a little better if we did not focus on this as an issue between this House and the other place, or, indeed, between the Executive and Parliament. We need to ","My Lords, Amendment 17 is tremendously important because it seeks to assert that the decisions on these matters should be taken by Parliament. I have great difficulty understanding why the Prime Minis","My Lords, I hope that the noble Viscount will be kind enough to allow me to interpose very briefly. I support the thrust of Amendment 17 and certainly the aim that it seeks to achieve, but I have a co","My Lords, I know the hour is late so I will be very short; I will confine myself to making three points. The first is to adopt the language of my noble friend Lord Deben. This House must recognise tha","My Lords, it is very late. We are tired. I do not know about the rest of your Lordships but I certainly am. I have sat here for four hours, a speech burning in my head, but listening to the speeches t","Noble Lords will be pleased to know that I, too, am not going to repeat the arguments put so succinctly by the noble Lord, Lord Pannick, nor the wise words of the noble and learned Lord, Lord Hope—alt","My Lords, this has been an excellent and interesting debate, and I am slightly wary at this late hour to be inserting myself between the noble and learned Lord, Lord Hope, and the noble Lord, Lord Pan","I am grateful to the Minister, although I am disappointed that he did not give the undertaking that the noble Lord, Lord Higgins, asked of him: that he answer definitively by next Tuesday complex ques","My Lords, Amendment 21 would underpin the involvement of devolved Administrations in the Brexit process. It would both formalise and strengthen the arrangements that the Government have already put in","My Lords, as the noble Baroness mentioned, it is still St David’s Day—just. I have my name on Amendment 21 and support what was said about the absolute need to ensure that the devolved Administrations","My Lords, in proposing Amendment 43, I accept totally everything that has been said by the noble Baroness, Lady Hayter, and my noble friend Lord Wigley in respect of their amendments. Those amendments","My Lords, the first point in my notes is to remind your Lordships that today is St David’s Day. There have been moments in the last couple of hours when I wondered if I would have to scrub that bit, b","My Lords, I will briefly make three points about Amendment 21. I should say that I am a member of your Lordships’ European Union Committee, and that I am a great fan of devolution. I am certainly a fa","I am grateful to the noble Lord. Far be it for me to try to defend the SNP; I have no authority to do so and probably no ability or knowledge either. But is not one of the factors that the outcome of ","I am grateful for that point but, as we sit here tonight, we have heard a lot of very different views; it does not mean that we do not sit down, discuss things and try to persuade people to come round","My Lords, we might still get the opportunity to wish our Welsh colleagues a very happy St David’s Day. As somebody who has a maternal name of Owens and a fraternal name of Morgan, I suppose there migh","I understand that in broad agricultural terms there is a European policy, but the agricultural policies followed in Wales at the micro level have been  very substantial. Some of the powers being repat","I am not disputing that. We have had agricultural powers in Northern Ireland for even longer, but they are confined within a broad policy set by the CAP. Yes there is micro stuff, and I am 100% for th","My Lords, I want to add the support of my Front Bench for the amendment and the words written by my noble friend Lady Randerson. Not only do I personally not come from Scotland, Wales or Northern Irel","I was referring to subsection (1) of the proposed new clause, where it says that the arrangements “have been agreed”. The word “agreement” surely means agreement.","It is agreeing on arrangements. It does not mean that you agree on the outcome. It is agreeing arrangements for consultation and how views will be taken into account. It does not specify that everyone","I thank noble Lords who have contributed to this part of the debate. The lateness of the hour does not reflect the importance of the issues being considered. I recognise the power of feeling in the Ho","We have heard that there are problems in Northern Ireland and, perhaps, an unwillingness to accept some of the attitudes taken by the Government in Scotland. However, the Government have an agreed Whi","My Lords, I can absolutely assure the noble Lord that we are taking into consideration not only the White Paper from Wales but the submissions prepared by the Scottish Government. All these matters ha","I thank the noble and learned Lord for his response. My only response is to the noble Earl, Lord Kinnoull, where I agree with the noble Baroness, Lady Ludford. The only agreement was about the way to ","My Lords, this is a Cinderella amendment—it seems to have been difficult to find the right place for it. This is an interesting list of bodies. It reminds us that Europe, the economy and society have ","My Lords, I shall be as quick as I possibly can in supporting my noble friend’s amendment. As my noble friend said, this a disparate  group of agencies with different structures. Many of them do not e","My Lords, very briefly at this late hour, I want to say how grateful we are to the noble Lord, Lord Lea, for raising the list that he has produced for us. On behalf of these Benches, I would say that ","Good morning, my Lords. I am grateful for the opportunity to speak to this amendment again, as I did on Monday night.Let me start by saying that these agencies are important and I was not wishing in a","The White Paper has only seven lines addressed to agencies.","I entirely concede that point. Forgive me: I have obviously not expressed myself well at this early hour of the morning. What I am saying is that those agencies touch on different areas of policy.I en","I thank the noble Lord, but I hope that he will reflect on one point. It is not the case that there is legal clarity at the moment about the legal status of some of these bodies and about what is cons"],["(Lab)","(Con)","(LD)","(Con)","(Con)","(Lab)","(Con)","(CB)","(Con)","(Lab)","(Con)","(Con)","(Con)","(Lab)","(Con)","(Lab)","(CB)","(Lab)","(Con)","spiritual","(GP)","spiritual","(CB)","(PC)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(LD)","(Con)","(LD)","(Con)","(LD)","(Con)","(Con)","(Con)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(Con)","(Lab)","(Con)","(CB)","(LD)","(CB)","(Con)","(Con)","(Lab)","(LD)","(Con)","(LD)","(LD)","(LD)","(Con)","(CB)","(Con)","(Con)","(Lab)","(CB)","(Lab)","spiritual","(Lab)","(Con)","(LD)","(Con)","(LD)","(CB)","(Lab)","(Con)","(Con)","(Con)","(Con)","(Con)","(CB)","(Con)","(LD)","(Con)","(CB)","(Con)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(Con)","(Lab)","(Lab)","(LD)","(Lab)","(Lab)","(CB)","(Con)","(Lab)","(Con)","(LD)","(CB)","(CB)","(Lab)","(Lab)","(Lab)","(Con)","(PC)","(LD)","(Lab)","(LD)","(LD)","(LD)","(CB)","(CB)","(Lab)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(LD)","(Con)","(CB)","(Con)","(Lab)","(Con)","(LD)","(GP)","(PC)","(Lab)","(LD)","(LD)","(Lab)","(Con)","(Con)","(Con)","(Con)","(CB)","(Lab)","(LD)","(Lab)","(LD)","(Lab)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(Con)","(Lab)","(Con)","(Lab)","(Con)","(GP)","(CB)","(Con)","(CB)","(Con)","(Con)","(Con)","(CB)","(Con)","(PC)","(Con)","(CB)","(Con)","(LD)","(Con)","(CB)","(Con)","(CB)","(Con)","(LD)","(Con)","(LD)","(Con)","(LD)","(CB)","(LD)","(Con)","(LD)","(CB)","(CB)","(CB)","(Con)","(Lab)","(Con)","(CB)","(Con)","(Con)","(CB)","(GP)","(Con)","(LD)","(Con)","(CB)","(Con)","(LD)","(Con)","(Con)","(CB)","(Con)","(LD)","(Lab)","(Con)","(CB)","(Lab)","(PC)","(CB)","(LD)","(CB)","(PC)","(CB)","(UUP)","(PC)","(UUP)","(LD)","(CB)","(LD)","(Con)","(PC)","(Con)","(Lab)","(Lab)","(Lab)","(LD)","(Con)","(Lab)","(Con)","(Lab)"],["female","male","female","male","male","male","male","male","male","female","male","male","male","male","male","male","female","male","female","male","female","male","male","male","male","male","male","female","male","male","male","male","male","male","male","male","male","male","male","male","female","male","male","female","male","male","female","male","male","male","female","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","male","female","male","male","male","male","male","male","male","male","male","female","male","male","male","male","male","male","male","male","male","female","female","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","male","female","male","male","male","male","female","male","male","male","male","male","male","male","male","male","male","male","female","male","male","female","male","female","male","female","female","male","male","male","male","male","female","female","female","male","male","male","male","male","male","male","male","female","male","female","male","female","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","male","female","female","male","male","male","male","male","female","male","male","male","male","male","male","female","male","male","male","male","female","male","male","female","male","male","female","male","male","male","male","male","male","female","male","female","male","male","male","female","male","male","male","male","male","male","male"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>text<\/th>\n      <th>party<\/th>\n      <th>gender<\/th>\n      <th>speech_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":5},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div id="link-to-the-app" class="section level2">
<h2><a href="https://mattc-apps.shinyapps.io/hansard_cleaner_final/">Link to the app</a></h2>
<p>Or read more below…</p>
<p>I wrote a script which pretty much does all of this <a href="https://github.com/mogs-git/hansard_cleaner_final/tree/master/cleaning_script">for you</a>, but realised that it would be even more powerful for those who don’t use R to be able to just upload Hansard text files to an app, and have the app do all the processing, then let users download the tidy spreadsheets. Below, and linked <a href="https://mattc-apps.shinyapps.io/hansard_cleaner_final/">here</a> is a free app written using Shiny R that does all this.</p>
<p>Currently it only works for Hansards from the House of Lords, mainly because lots of the functions rely on naming conventions used in the House of Lords. All I mean by that really is you can infer gender from the title of the lord, and titles are standardised making it easier to identify headings etc… But I’m working on a version that also tidies Hansards from the House of Commons. I’d also previously done some webscraping using <code>rvest</code> to get more information about each Lords political party, which I’m yet to repeat for the MPs in the House of Commons.</p>
<p>At some point I’ll update this post with more information about the code involved, but here are the key features:</p>
<pre class="r"><code>create_header_table &lt;- function(hansard_plaintext) {
  tibble(headers = unlist(str_extract_all(hansard_plaintext, &quot;\n[^\n\r]*\r&quot;))) %&gt;% # pull out all headers
    mutate(possible_name = str_length(headers) &lt; 150 &amp; !str_detect(headers, &quot;\r\n\r\n&quot;)) %&gt;% # mark those short enough to be a name
    filter(possible_name)
}</code></pre>
<p>It begins by basically searching through the text file for escape character sequences that indicate headers. It then systematically searches this for headers that might be the names of peers.</p>
<pre class="r"><code>extract_base_names &lt;- function(peers_id) {
  peers_id %&gt;% 
    mutate(base_name = case_when(
      awkward ~ str_sub(str_extract(entire_title, &quot;\\([^)]+\\)&quot;), 2, -2), # if two sets of brackets, get name from first set
      !awkward &amp; contains_party ~ str_sub(str_extract(entire_title, &quot;[a-zA-Z &#39;,\\-]+&quot;), 1, -2), # if party, ignore party
      !awkward &amp; !contains_party ~ entire_title # if just a name, just use the name
    ))
}</code></pre>
<p>The names of peers come in different forms (sometimes they have party attached, or a different title preceding them), so we then need to pull out a unique name identifying each peer.</p>
<pre class="r"><code>create_party_id_table &lt;- function(peers_id) {
  out &lt;- peers_id %&gt;%
    filter(contains_party) %&gt;%
    mutate(party = str_extract(entire_title, &quot;\\([a-zA-Z-]*\\)&quot;)) %&gt;%
    distinct(base_name, party) 
  
  out
}</code></pre>
<p>The political party of each Peer is written in the first header which they appear in, in brackets. For example “Baroness Hayter of Kentish Town (Lab)”. This function searches for that header and pulls out the party for that Peer.</p>
<pre class="r"><code>add_gender &lt;- function(df) {
  printf &lt;- function(...) invisible(print(sprintf(...)))
  
  gender_vector &lt;- vector(&quot;character&quot;, length(df$base_name))
  for (i in seq_along(df$base_name)) {
    if (str_detect(df$base_name[i], &quot;Lord|Viscount|Archbishop|Bishop|Earl&quot;)) {
      gender_vector[i] &lt;- &quot;male&quot;
    } else if (str_detect(df$base_name[i], &quot;Baroness|Lady|Countess|Duchess&quot;)){
      gender_vector[i] &lt;- &quot;female&quot;
    } else {
      gender_vector[i] &lt;- NA
    }
  }
  
  out &lt;- df %&gt;% add_column(gender = gender_vector)
  
  n_unassigned &lt;- sum(is.na(out$gender))
  
  if (n_unassigned == 0) {
    printf(&quot;All Peers assigned to a gender!&quot;)
  } else {
    printf(&quot;%i Peers could not be assigned to a gender. Check is.na(.$gender).&quot;, n_unassigned)
  }
  
  return(out)
}</code></pre>
<p>Later on this gnarly looking function (which is actually pretty simple) assigns a gender to each Peer. Gender is inferred in a lovely hard-coded way by looking at the title of the peer preceding their name.</p>
<pre class="r"><code>bind_text &lt;- function(hansard_plaintext, peers, remove_exclamations=T) {
  
  # First task, find all headers and their start and end locations
  loc &lt;- tibble(headers = str_sub(unlist(str_extract_all(hansard_plaintext, &quot;\n[^\n\r]*\r&quot;)), start = 2, end = -2),
                start = str_locate_all(hansard_plaintext, &quot;\n[^\n\r]*\r&quot;)[[1]][,1],
                end = str_locate_all(hansard_plaintext, &quot;\n[^\n\r]*\r&quot;)[[1]][,2]) 
  
  # extract the headers which we have previously confirmed as belonging to peers
  peer_headers &lt;- unique(peers$entire_title) # all headers corresponding to a peer
  
  # Using the headers assigned to peers and their locations in the text,
  # assume that all the text between these headers belongs to a single speech for that peer, and
  # assign it to that Lord.
  peers &lt;- distinct(peers)
  
  text &lt;- loc %&gt;%
    filter(headers %in% peer_headers) %&gt;%
    mutate(speech_start = end, speech_end = lead(start),
           speech_end = ifelse(is.na(speech_end), str_length(hansard_plaintext), speech_end)) %&gt;% # If last speech, it ends at the end of the hansard (bit sketchy)
    select(-start, -end) %&gt;%
    mutate(text = str_sub(hansard_plaintext, speech_start, speech_end),
           text = str_replace_all(text, &quot;\\n|\\r&quot;, &quot;&quot;),
           text = str_replace_all(text, &quot;[0-9][0-9]:[0-9][0-9]:[0-9][0-9]&quot;, &quot;&quot;)) %&gt;%
    select(-speech_start, -speech_end) 
  
  # Now clean up this table using the peers tibble
  
  text &lt;- text %&gt;%
    rename(entire_title=headers) %&gt;%
    left_join(peers, by = &quot;entire_title&quot;) %&gt;%
    rename(name=base_name) %&gt;%
    select(name, text, party, gender) %&gt;%
    {if(remove_exclamations) filter(., !str_detect(text, &quot;^My Lords—$&quot;)) else .} %&gt;%
    mutate(speech_id = row_number())
  
  return(text)
}</code></pre>
<p>Finally for the biggest but most important function, <code>bind_text()</code>. This is also conceptually very simple, don’t let the code scare you away. There are really only two steps:</p>
<ul>
<li>Search for location of headers corresponding to a Peer (The start of a speech)</li>
<li>Find all the text <strong>between</strong> each of these headers, and pair this with the previous header.</li>
</ul>
<p>That’s all there is to it. I’ve skipped out some less important steps, but all it really amounts to is identfying Peers in the headers, adding data like gender and party, and finally pulling out the text associated with each speech.</p>
<div id="the-tidy-hansard-app" class="section level4">
<h4>The tidy HansaRd app</h4>
<iframe height="600" width="1200" src="https://mattc-apps.shinyapps.io/hansard_cleaner_final/">
</iframe>
</div>
</div>
